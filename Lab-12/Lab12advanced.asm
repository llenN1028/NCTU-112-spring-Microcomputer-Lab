ORG 0000H
AJMP INITIAL
ORG 0023H
AJMP RECEIVE
ORG 0050H


INITIAL:
	SETB ES
	CLR TI
	CLR RI
	SETB EA
	SETB PS 
	;set serial port

	MOV TMOD, #00100000B ;Timer1, Mode2 Timer0, Mode0
	MOV TL1, #230
	MOV TH1, #230 ;baud rate=2400
	ORL PCON, #80H ;SMOD=1
	SETB TR1 
	;set baud rate

	CLR SM2
	SETB SM1
	CLR SM0
	SETB REN ;recieve enable
	;serial port mode1
	 	
	SETB P0.0
LOOP:
	JMP $

RECEIVE:
	CLR RI
	MOV A, SBUF	 
	ACALL DO
	RETI

DO:
	
	CJNE A, #'1', RE
	
	MOV TL0, #12
	MOV TH0, #196

	MOV R3, #4
	SETB TR0

DELAYDO:
	MOV R2, #131
DELAYDO1:
	ACALL INVERTDO
	DJNZ R2, DELAYDO1
	DJNZ R3, DELAYDO
	CLR TR0
	RET

INVERTDO:
	CPL P0.0
	JNB TF0, $
	CLR TF0
	MOV TL0, #12
	MOV TH0, #196
	RET

RE:

	CJNE A, #'2', MI
	
	MOV TL0, #28
	MOV TH0, #202

	MOV R3, #3
	SETB TR0

DELAYRE:
	MOV R2, 196
DELAYRE1:
	ACALL INVERTRE
	DJNZ R2, DELAYRE1
	DJNZ R3, DELAYRE
	CLR TR0
	RET

INVERTRE:
	CPL P0.0
	JNB TF0, $
	CLR TF0
	MOV TL0, #28
	MOV TH0, #202
	RET	

MI:

	CJNE A, #'3', FA
	
	MOV TL0, #21
	MOV TH0, #208

	MOV R3, #3
	SETB TR0

DELAYMI:
	MOV R2, #220
DELAYMI1:
	ACALL INVERTMI
	DJNZ R2, DELAYMI1
	DJNZ R3, DELAYMI
	CLR TR0
	RET

INVERTMI:
	CPL P0.0
	JNB TF0, $
	CLR TF0
	MOV TL0, #21
	MOV TH0, #208
	RET	

FA:

	CJNE A, #'4', SO
	
	MOV TL0, #8
	MOV TH0, #211

	MOV R3, #3
	SETB TR0

DELAYFA:
	MOV R2, #233
DELAYFA1:
	ACALL INVERTFA
	DJNZ R2, DELAYFA1
	DJNZ R3, DELAYFA
	CLR TR0
	RET

INVERTFA:
	CPL P0.0
	JNB TF0, $
	CLR TF0
	MOV TL0, #8
	MOV TH0, #211
	RET	


SO:

	CJNE A, #'5', LA
	
	MOV TL0, #5
	MOV TH0, #216

	MOV R3, #4
	SETB TR0

DELAYSO:
	MOV R2, #196
DELAYSO1:
	ACALL INVERTSO
	DJNZ R2, DELAYSO1
	DJNZ R3, DELAYSO
	CLR TR0
	RET

INVERTSO:
	CPL P0.0
	JNB TF0, $
	CLR TF0
	MOV TL0, #5
	MOV TH0, #216
	RET	


LA:
	
	CJNE A, #'6', SI
	
	MOV TL0, #16
	MOV TH0, #220

	MOV R3, #4
	SETB TR0

DELAYLA:
	MOV R2, #220
DELAYLA1:
	ACALL INVERTLA
	DJNZ R2, DELAYLA1
	DJNZ R3, DELAYLA
	CLR TR0
	RET

INVERTLA:
	CPL P0.0
	JNB TF0, $
	CLR TF0
	MOV TL0, #16
	MOV TH0, #220
	RET	

SI:

	CJNE A, #'7', RESET 
	
	MOV TL0, #12
	MOV TH0, #224

	MOV R3, #4
	SETB TR0

DELAYSI:
	MOV R2, #247
DELAYSI1:
	ACALL INVERTSI
	DJNZ R2, DELAYSI1
	DJNZ R3, DELAYSI
	CLR TR0
	RET

INVERTSI:
	CPL P0.0
	JNB TF0, $
	CLR TF0
	MOV TL0, #12
	MOV TH0, #224
	RET	
RESET:
	RET
	END
