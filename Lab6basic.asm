ORG 0000H
AJMP START
ORG 0050H

TABLE:
	DB 11000000B ;0
	DB 11111001B ;1
	DB 10100100B ;2
	DB 10110000B ;3
	DB 10011001B ;4
	DB 10010010B ;5
	DB 10000010B ;6
	DB 11111000B ;7
	DB 10000000B ;8
	DB 10011000B ;9
	DB 10001000B ;A
	DB 10000011B ;B
	DB 11000110B ;C
	DB 10100001B ;D
	DB 10000110B ;E
	DB 10001110B ;F
START:
	MOV DPTR, #TABLE
	MOV P3, #00H
	MOV P0, #0FFH
ROW1:
	MOV R3, P1
	MOV P1, #7FH
	CALL DELAY
	MOV A, P1
	ANL A, #0FH
	MOV R1, #0
	CJNE A, #0FH, COL1
ROW2:
	MOV P1, #0BFH
	CALL DELAY
	MOV A, P1
	ANL A, #0FH
	MOV R1, #4
	CJNE A, #0FH, COL1
ROW3:
	MOV P1, #0DFH
	CALL DELAY
	MOV A, P1
	ANL A, #0FH
	MOV R1, #8
	CJNE A, #0FH, COL1
ROW4:
	MOV P1, #0EFH
	CALL DELAY
	MOV A, P1
	ANL A, #0FH
	MOV R1, #12
	CJNE A, #0FH, COL1
	AJMP ROW1
COL1:
	CJNE A, #0EH, COL2
	MOV R0, #0
	JMP OUTPUT
COL2:
	CJNE A, #0DH, COL3
	MOV R0, #1
	JMP OUTPUT
COL3:
	CJNE A, #0BH, COL4
	MOV R0, #2
	JMP OUTPUT
COL4:
	CJNE A, #07H, ROW1
	MOV R0, #3
	JMP OUTPUT
OUTPUT:
	MOV A, R0
	ADD A, R1
	MOVC A, @A+DPTR
	MOV P0, A
	MOV P3, #0FEH
	MOV A, P1
	CJNE A, 3, START
	AJMP OUTPUT
DELAY:
	MOV R6, #100
DELAY1:
	MOV R7, #200
DELAY2:
	DJNZ R7, DELAY2
	DJNZ R6, DELAY1
	RET
	END














